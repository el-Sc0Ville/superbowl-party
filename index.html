<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Super Bowl LX Results</title>
    <style>
        :root { --primary: #002244; --secondary: #69BE28; --accent: #C60C30; --bg: #f4f4f4; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: var(--bg); margin: 0; padding: 0; color: #333; }
        .header { background: linear-gradient(135deg, #002244 0%, #00152A 100%); color: white; padding: 20px; text-align: center; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .header h1 { margin: 0; font-size: 1.5rem; letter-spacing: 1px; }
        .header p { margin: 5px 0 0; opacity: 0.8; font-size: 0.9rem; }
        .container { max-width: 600px; margin: 0 auto; padding: 20px; }

        /* Navigation */
        .nav-buttons { display: flex; gap: 10px; margin-bottom: 20px; }
        .nav-btn { background: #ddd; color: #333; border: none; padding: 10px 20px; border-radius: 20px; font-weight: bold; flex: 1; cursor: pointer; transition: 0.2s; }
        .nav-btn.active { background: var(--secondary); color: white; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }

        /* Payment Banner */
        .payment-alert { background-color: #fff3cd; color: #856404; padding: 15px; border-radius: 8px; border: 1px solid #ffeeba; text-align: center; margin-bottom: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .payment-alert a { font-weight: bold; color: #002244; }

        /* Winners Podium */
        .podium-card { background: linear-gradient(135deg, #FFD700 0%, #FDB931 100%); color: #002244; padding: 20px; border-radius: 12px; text-align: center; margin-bottom: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.15); display: none; }
        .podium-card h2 { margin: 0 0 10px 0; font-size: 1.4rem; }
        .winner-name { font-size: 1.8rem; font-weight: 900; margin: 10px 0; }
        .winner-score { font-size: 1.2rem; background: rgba(255,255,255,0.3); padding: 5px 15px; border-radius: 20px; display: inline-block; }

        /* Tables */
        .data-table { width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .data-table th { background: var(--primary); color: white; padding: 12px; text-align: left; }
        .data-table td { padding: 12px; border-bottom: 1px solid #eee; }
        .data-table tr:last-child td { border-bottom: none; }
        
        .rank-1 { background-color: #FFF8E1; border-left: 5px solid #FFD700; }
        .rank-2 { border-left: 5px solid #C0C0C0; }
        .rank-3 { border-left: 5px solid #CD7F32; }
        .score-cell { font-weight: bold; font-size: 1.1rem; color: var(--secondary); text-align: right; }
        
        .answer-key-row td { font-size: 0.9rem; }
        .answer-correct { font-weight: bold; color: var(--secondary); }

        /* Sections */
        #answers-view { display: none; }
    </style>
</head>
<body onload="loadData()">

<div class="header">
    <h1>6Ô∏è‚É£7Ô∏è‚É£ McNabb<br> Super Bowl Party üèàüèüÔ∏è</h1>
    <p>Seahawks vs. Patriots ‚Ä¢ Final Results üèÜ</p>
</div>

<div class="container">

    <div class="payment-alert">
        <strong>‚ö†Ô∏è Housekeeping:</strong><br>
        If you haven't paid your entry fee yet, please send it ASAP! üôè<br>
        <br>
        üí∏ <strong>pat.normandin@gmail.com</strong>
    </div>

    <div id="winners-podium" class="podium-card">
        <h2>üèÜ CHAMPION üèÜ</h2>
        <div id="winner-list"></div>
    </div>

    <div class="nav-buttons">
        <button class="nav-btn active" onclick="showSection('leaderboard')" id="btn-board">Leaderboard</button>
        <button class="nav-btn" onclick="showSection('answers')" id="btn-answers">Correct Answers</button>
    </div>

    <div id="leaderboard-view">
        <table class="data-table">
            <thead>
                <tr>
                    <th style="width: 15%">#</th>
                    <th>Player</th>
                    <th style="text-align: right">Score</th>
                </tr>
            </thead>
            <tbody id="leaderboard-body">
                <tr><td colspan="3" style="text-align:center; padding: 20px;">Fetching final scores...</td></tr>
            </tbody>
        </table>
    </div>

    <div id="answers-view">
        <table class="data-table">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Question</th>
                    <th style="text-align: right">Result</th>
                </tr>
            </thead>
            <tbody id="answers-body">
                </tbody>
        </table>
    </div>

</div>

<script>
    // YOUR EXISTING SCRIPT URL
    const scriptURL = 'https://script.google.com/macros/s/AKfycbyvS3rvvRFbPEpM1EAuiPPC25dO5-HBmpf0YatIuD6RW57e0vlPm2D6Y4-TQqMQrkSMRQ/exec';

    function showSection(section) {
        document.getElementById('leaderboard-view').style.display = section === 'leaderboard' ? 'block' : 'none';
        document.getElementById('answers-view').style.display = section === 'answers' ? 'block' : 'none';
        
        document.getElementById('btn-board').className = section === 'leaderboard' ? 'nav-btn active' : 'nav-btn';
        document.getElementById('btn-answers').className = section === 'answers' ? 'nav-btn active' : 'nav-btn';
    }

    function loadData() {
        fetch(scriptURL)
            .then(response => response.json())
            .then(data => {
                const headers = data[0];
                const answers = data[1];
                const guests = data.slice(3);

                // --- 1. BUILD LEADERBOARD & FIND WINNER ---
                let players = guests.map(row => {
                    return { name: row[0], score: row[1] === "" ? 0 : row[1] };
                });
                
                players = players.filter(p => p.name && p.name !== "");
                players.sort((a, b) => b.score - a.score);

                const tbody = document.getElementById('leaderboard-body');
                tbody.innerHTML = '';
                
                players.forEach((player, index) => {
                    let rankClass = '';
                    if (index === 0) rankClass = 'rank-1';
                    if (index === 1) rankClass = 'rank-2';
                    if (index === 2) rankClass = 'rank-3';

                    tbody.innerHTML += `
                        <tr class="${rankClass}">
                            <td>${index + 1}</td>
                            <td style="font-weight:500">${player.name}</td>
                            <td class="score-cell">${player.score}</td>
                        </tr>
                    `;
                });

                // --- 2. SHOW WINNERS PODIUM ---
                if (players.length > 0) {
                    const topScore = players[0].score;
                    const winners = players.filter(p => p.score === topScore);
                    
                    const winnerDiv = document.getElementById('winner-list');
                    winnerDiv.innerHTML = ''; 
                    
                    winners.forEach(w => {
                        winnerDiv.innerHTML += `
                            <div class="winner-name">${w.name}</div>
                            <div class="winner-score">${w.score} Points</div><br>
                        `;
                    });
                    
                    document.getElementById('winners-podium').style.display = 'block';
                }

                // --- 3. BUILD ANSWER KEY (Including new Column R) ---
                const answerBody = document.getElementById('answers-body');
                answerBody.innerHTML = '';

                // Count from 2 (Col C) up to 17 (Col R)
                let questionCount = 1;
                for (let i = 2; i <= 17; i++) {
                    if (headers[i] && headers[i] !== "") {
                        answerBody.innerHTML += `
                            <tr class="answer-key-row">
                                <td style="color:#888">${questionCount}</td>
                                <td>${headers[i]}</td>
                                <td style="text-align: right;" class="answer-correct">${answers[i]}</td>
                            </tr>
                        `;
                        questionCount++;
                    }
                }

            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById('leaderboard-body').innerHTML = '<tr><td colspan="3">Error loading data.</td></tr>';
            });
    }
</script>

</body>
</html>
